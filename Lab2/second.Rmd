---
title: "Лабораторная работа №2"
author: "Usov Danil"
date: "17 05 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## Тема №1: Точечные оценки параметров методом моментов
Цель работы − научиться генерировать выборки с заданными параметрами и определять точечные оценки параметров выборок методом моментов.

### 1. Нормальный закон распределения.

Сгенерируем выборку:
```{r}
x1 = rnorm(788, 59, 69)
str(x1)
```
Найдём оценки неизвестных параметров:
```{r}
a = mean(x1); a
si = sd(x1); si
```

### 2. Показательный закон распределения.

Сгенерируем выборку:
```{r}
x2 = rexp(700, 27)
str(x2)
```
Найдём оценки неизвестных параметров:
```{r}
lam = 1 / mean(x2); lam
```

### 3. Биномиальный закон распределения.

Сгенерируем выборку:
```{r}
x3 = rbinom(700, 42, 0.8)
str(x3)
```
Найдём оценки неизвестных параметров:
```{r}
p = mean(x3) / 20; p
n = mean(x3) / 0.6; n
```
Вывод: 

## Тема №2: Сравнение способов оценивания
Целью лабораторной работы является изучение трех способов статистического оценивания: оценка, полуенная методом моментов; оценка, полученная методом максимального правдоподобия; оценка, полученная методом порядковых статистик.

## Тема №3: Проверка на нормальность распределения

H0 - данная выборка не принадлежит нормальному распределению
H1 - данная выборка принадлежит нормальному распределению
alpha = 0.05
```{r}
library(sm)
library(nortest)
Data <- read.csv("region.txt", sep = '\t')
wmratio <- Data$Соотношение.мужчин.и.женщин...женщин.на.1000.мужчин.
hist(wmratio, 20)
sm.density(wmratio, model="Normal", xlab = "Выборка", ylab="Функция плотности распределения")
lillie.test(wmratio)
library(moments)
skewness(wmratio)
kurtosis(wmratio)
```
По результатам теста можно видеть, что значение p меньше 0.05, следовательно, принимается нулевая гипотеза о отсутствии принадлежности выборки нормальному распределения. По оценкам коэффицентов можно сделать вывод, что распределение скошено вправо и имеется заметный пик.


## Тема № 4: Изучение корреляционной зависимости двух случайных величин

```{r}
Data <- read.csv("region.txt", sep='\t')
x <- Data$Оборот.розничной.торговли..млн.руб..
y <- Data$Обьем.промышленной.продукции..млн.руб..
cor.test(x, y)
```
H0 - корреляция между векторами отсутствует, следовательно коэффициент корреляции равен нулю.
H1 - корреляция между векторами присутствует, следовательно коэффициент корреляции не равен нулю.
Коэффициент корреляции Пирсона больше 0.7, поэтому данные можно считать коррелированными.

```{r}
cor.test(x, y, method = "kendall", conf.level = 0.95)
cor.test(x, y, method = "kendall", conf.level = 0.99)
```

Для a = 0.05 p-value < a, следовательно нулевая гипотеза отвергается.
Для a = 0.01 p-value < a, следовательно нулевая гипотеза отвергается.

```{r}
cor.test(x, y, method = "spearman", conf.level = 0.95)
cor.test(x, y, method = "spearman", conf.level = 0.99)
```
Для a = 0.05 p-value < a, следовательно нулевая гипотеза отвергается.
Для a = 0.01 p-value < a, следовательно нулевая гипотеза отвергается.

## Тема № 5: Коэффициент конкордации

Значение коэффициента конкордации может находится в диапазоне от 0 до 1. Если W=0, считается, что мнения экспертов не согласованны. Если W=1, то оценки экспертов полностью согласованны.
H0 - коэффициент конкордации незначимый.
H1 - коэффициент коркордации значим.
```{r}
library(vegan)
x <- read.table("2.txt", header=FALSE)
kendall.global(x, nperm=999, mult="holm")
```
p < 0.05, значит, нулевая гипотеза отвергается и коэффициент конкордации можно считать значимым.
По данному анализу видно, что коэффициент конкордации равен примерно 0.5 . Это говорит о средней согласованности между экспертами.